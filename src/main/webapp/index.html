<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Java Enterprise (Topjava)</title>
</head>
<body>
<h3>Проект <a href="https://github.com/JavaWebinar/topjava" target="_blank">Java Enterprise (Topjava)</a></h3>
<hr>
<p>
    <label for="userId">User:</label>
    <select name="userId" id="userId">
        <option value="1">Admin</option>
        <option value="2">Regular User</option>
    </select>
</p>
<ul style="font-size: large">
    <li><a href="users">Users</a></li>
    <li><a href="meals">Meals</a></li>
</ul>
<script>
    document.addEventListener('DOMContentLoaded', evt => {
        let select = document.querySelector("#userId");
        let setActualUser = function () {
            let xhr = new XMLHttpRequest();
            xhr.open("POST", "/topjava/users");
            xhr.send("GetActualUser");
            xhr.onload = function() {
                if (xhr.status === 200) {
                    select.value = xhr.response;
                }
            }
        };
        setActualUser();
        select.addEventListener('change', evt => {
            let xhr = new XMLHttpRequest();
            xhr.open("POST", "/topjava/users");
            xhr.send("userId=" + select.value);
        });
    });
</script>
</body>
</html>
